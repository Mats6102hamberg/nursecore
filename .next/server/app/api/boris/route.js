"use strict";(()=>{var e={};e.id=261,e.ids=[261],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4917:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>f,requestAsyncStorage:()=>c,routeModule:()=>u,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var o={};r.r(o),r.d(o,{POST:()=>p});var s=r(9303),i=r(8716),n=r(670),a=r(7070);let d={medicine:"You are Boris AI for a private nurse portal. Focus on IBD and liver ward study support. Provide educational, general information only. Do not provide diagnosis, treatment decisions, or dosage guidance. If asked for patient-specific advice or dosing, refuse and remind the user to follow local PM and responsible physician.",icu:"You are Boris AI for a private nurse portal. Focus on ICU study support. Provide educational, general information only. Do not provide diagnosis, treatment decisions, or dosage guidance. If asked for patient-specific advice or dosing, refuse and remind the user to follow local PM and responsible physician."};async function p(e){let t=process.env.OPENAI_API_KEY;if(!t)return a.NextResponse.json({error:"Missing OPENAI_API_KEY."},{status:500});let r=await e.json().catch(()=>null),o=r?.message,s=r?.mode;if(!o||"string"!=typeof o||!s)return a.NextResponse.json({error:"Invalid request."},{status:400});if("medicine"!==s&&"icu"!==s)return a.NextResponse.json({error:"Invalid mode."},{status:400});if(function(e){let t=e.toLowerCase(),r=/\b(mrn|medical record|dob|date of birth|ssn|social security|address|phone|email)\b/.test(t)||/\b\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}\b/.test(t)||/\b\d{3}[-\s]?\d{2}[-\s]?\d{4}\b/.test(t)||/\b\d{3}[-\s]?\d{3}[-\s]?\d{4}\b/.test(t),o=/\b(patient|pt|room|bed|unit)\b/.test(t)&&/\b(age|yo|y\/o|male|female|m|f|room|bed)\b/.test(t);return r||o}(o)||function(e){let t=e.toLowerCase(),r=/\b\d+(\.\d+)?\s?(mg|mcg|g|kg|ml|units|iu|u\/kg|mg\/kg|mcg\/kg|mmol|meq|gtt|min)\b/.test(t),o=/\b(dose|dosage|titrate|start|stop|increase|decrease|prescribe|order|give|administer|treat|treatment plan|diagnose|what should i do)\b/.test(t);return r||o}(o))return a.NextResponse.json({reply:"I can't help with patient-specific details, medical decisions, or dosing. Please use local PM and refer to the responsible physician. I can help with general study concepts or nursing education instead."});let i=await fetch("https://api.openai.com/v1/responses",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({model:"gpt-4o-mini",temperature:.2,instructions:d[s],input:o})});if(!i.ok)return a.NextResponse.json({error:"Upstream request failed."},{status:502});let n=await i.json(),p=Array.isArray(n?.output)?n.output.flatMap(e=>Array.isArray(e.content)?e.content.filter(e=>"output_text"===e.type).map(e=>e.text??""):[]).join(""):"";return a.NextResponse.json({reply:p||"No response available. Please try again."})}let u=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/boris/route",pathname:"/api/boris",filename:"route",bundlePath:"app/api/boris/route"},resolvedPagePath:"/Users/admin/Projects/nursecore/src/app/api/boris/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:c,staticGenerationAsyncStorage:l,serverHooks:m}=u,g="/api/boris/route";function f(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[276,972],()=>r(4917));module.exports=o})();